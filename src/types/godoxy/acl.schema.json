{"$ref":"#/definitions/ACLConfig","$schema":"http://json-schema.org/draft-07/schema#","definitions":{"ACLConfig":{"additionalProperties":false,"description":"ACL config","properties":{"allow":{"description":"Allow list","items":{"$ref":"#/definitions/ACLMatcher"},"type":"array"},"allow_local":{"default":true,"description":"Allow local addresses","type":"boolean"},"default":{"default":"allow","description":"Default action","enum":["allow","deny"],"type":"string"},"deny":{"description":"Deny list","items":{"$ref":"#/definitions/ACLMatcher"},"type":"array"},"log":{"$ref":"#/definitions/ACLLogConfig","description":"ACL logger"},"notify":{"additionalProperties":false,"description":"ACL Summary notifer","properties":{"include_allowed":{"default":false,"description":"Include allowed IPs?","type":"boolean"},"interval":{"$ref":"#/definitions/Duration","default":"1m","description":"Notification interval"},"to":{"description":"Notification provider names","items":{"type":"string"},"type":"array"}},"type":"object"}},"type":"object"},"ACLLogConfig":{"additionalProperties":false,"properties":{"keep":{"$ref":"#/definitions/RetentionPolicy","default":"30 days","description":"Retention policy"},"log_allowed":{"default":false,"description":"Log allowed IPs?","type":"boolean"},"path":{"$ref":"#/definitions/URI","description":"Access log file path"},"retention":{"$ref":"#/definitions/RetentionPolicy","default":"30 days","description":"Retention policy"},"rotate_interval":{"$ref":"#/definitions/Duration","default":"24h","description":"Rotation interval"},"stdout":{"default":false,"description":"Log to stdout","type":"boolean"}},"type":"object"},"ACLMatcher":{"anyOf":[{"$ref":"#/definitions/IPMatcher"},{"$ref":"#/definitions/CIDRMatcher"},{"$ref":"#/definitions/CountryISOMatcher"},{"$ref":"#/definitions/TimezoneMatcher"}]},"CIDRMatcher":{"description":"CIDR matcher","examples":["cidr:192.168.1.0/24"],"type":"string"},"CountryISOMatcher":{"description":"Country ISO matcher","examples":["country:US"],"pattern":"country:\\w{2}","type":"string"},"Duration":{"description":"Duration","pattern":"^\\d+(?:us|ms|s|m|h|d|w|M)$","type":"string"},"IPMatcher":{"description":"IP matcher","examples":["ip:192.168.1.1"],"type":"string"},"LogKeepDays":{"type":"string"},"LogKeepLast":{"type":"string"},"LogKeepSize":{"type":"string"},"RetentionPolicy":{"anyOf":[{"$ref":"#/definitions/LogKeepDays"},{"$ref":"#/definitions/LogKeepLast"},{"$ref":"#/definitions/LogKeepSize"}],"default":"30 days","description":"Retention policy"},"TimezoneMatcher":{"description":"Timezone matcher","examples":["tz:America/New_York"],"pattern":"tz:\\w+\\/\\w+","type":"string"},"URI":{"description":"URI","format":"uri-reference","type":"string"}}}